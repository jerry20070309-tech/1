<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>âš¡ å°å¹«æ‰‹ X-TREME V14.1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@900&family=JetBrains+Mono:wght@800&display=swap');
        body { background: #080808; color: #e0e0e0; font-family: 'JetBrains Mono', 'Noto Sans TC', sans-serif; overflow: hidden; }
        .bg-grid { background-image: radial-gradient(#1a1a1a 1px, transparent 1px); background-size: 30px 30px; }
        
        /* æ ¸å¿ƒå¡ç‰‡èˆ‡ 90 åˆ†ç™¼å…‰ */
        .card { background: rgba(15, 15, 15, 0.95); border: 1px solid #333; transition: 0.3s; }
        .high-score { border: 2px solid #ff4444 !important; box-shadow: 0 0 20px rgba(255, 68, 68, 0.4); background: rgba(30, 0, 0, 0.9) !important; }

        /* ATR è­·ç›¾æ¢ */
        .shield-bg { height: 8px; background: #111; border-radius: 4px; position: relative; border: 1px solid #333; overflow: hidden; }
        .shield-fill { height: 100%; background: linear-gradient(90deg, #ff4444, #ffeb3b, #22c55e); opacity: 0.3; }
        .shield-pointer { position: absolute; top: 0; width: 4px; height: 100%; background: #fff; box-shadow: 0 0 8px #fff; transition: 0.3s; }

        /* æˆ°é¬¥æ—¥èªŒ (90åˆ†å°ˆå±¬) */
        #combat-log { font-size: 11px; color: #00ffcc; scrollbar-width: none; }
        .log-entry { border-left: 3px solid #ff4444; padding: 8px; margin-bottom: 8px; background: rgba(255, 68, 68, 0.1); border-radius: 0 4px 4px 0; animation: flash 0.5s ease-out; }
        @keyframes flash { from { background: #ff4444; } to { background: rgba(255, 68, 68, 0.1); } }

        /* æ§åˆ¶æŒ‰éˆ• */
        .mode-btn { background: #111; border: 1px solid #444; transition: 0.2s; font-weight: 900; font-style: italic; }
        .mode-btn:hover { border-color: #fff; background: #222; }
        .active-mode { border-color: #eab308 !important; color: #eab308; background: rgba(234, 179, 8, 0.1); }
    </style>
</head>
<body class="h-screen flex flex-col bg-grid">

    <header class="p-4 bg-black border-b-2 border-zinc-800 flex justify-between items-center">
        <h1 class="text-3xl font-black italic uppercase tracking-tighter text-white">Helper <span class="text-red-500">X-TREME</span></h1>
        <button id="sysBtn" onclick="toggleSystem()" class="bg-white text-black px-12 py-2 rounded-sm font-black hover:bg-red-600 hover:text-white transition-all italic">å•Ÿå‹•æ ¸å¿ƒæƒæ</button>
    </header>

    <nav class="bg-zinc-950 p-4 border-b border-zinc-800 grid grid-cols-12 gap-6 items-center shadow-2xl">
        <div class="col-span-4 flex gap-2 border-r border-zinc-800 pr-4">
            <button id="btn-ambush" onclick="applyMode('ambush')" class="mode-btn flex-1 py-2 rounded text-[10px] text-green-500">é€±æœ«åŸ‹ä¼</button>
            <button id="btn-hunt" onclick="applyMode('hunt')" class="mode-btn flex-1 py-2 rounded text-[10px] text-red-500">å¼·å‹¢çµæ®º</button>
            <button id="btn-vio" onclick="applyMode('vio')" class="mode-btn flex-1 py-2 rounded text-[10px] text-purple-500">æš´åŠ›ç•°å‹•</button>
        </div>
        
        <div class="col-span-8 grid grid-cols-3 gap-8">
            <div class="flex flex-col"><span class="text-[10px] font-black text-zinc-500 mb-1">ğŸŒ€ è“„å‹¢ (SQZ)</span><input type="range" id="i_sqz" min="5" max="50" value="12" class="accent-red-500"></div>
            <div class="flex flex-col"><span class="text-[10px] font-black text-zinc-500 mb-1">ğŸ¯ çªç ´ (POC)</span><input type="range" id="i_poc" min="1" max="100" value="11" class="accent-red-500"></div>
            <div class="flex flex-col"><span class="text-[10px] font-black text-zinc-500 mb-1">ğŸš€ çœŸç©º (DRV)</span><input type="range" id="i_drv" min="10" max="150" value="90" class="accent-red-500"></div>
        </div>
    </nav>

    <div class="flex flex-1 overflow-hidden">
        <main class="flex-1 p-4 overflow-y-auto">
            <div id="dashboard" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4"></div>
        </main>

        <aside class="w-80 border-l border-zinc-800 bg-black/80 p-4 flex flex-col">
            <div class="text-[11px] font-black mb-4 border-b border-zinc-700 pb-2 flex justify-between">
                <span class="text-red-500 italic uppercase">âš”ï¸ 90åˆ†ç´šæˆ°é¬¥å°å°ç´€éŒ„</span>
                <span id="log-count" class="text-zinc-600">0</span>
            </div>
            <div id="combat-log" class="flex-1 overflow-y-auto pr-2">
                </div>
        </aside>
    </div>

<script>
    const CONFIG = { EXCLUDE: ['BTCUSDT','ETHUSDT','SOLUSDT','XRPUSDT','BNBUSDT'] };
    let stats = {}, isRunning = false, loggedAssets = new Set();

    // çœŸæ­£çš„å¿«é€Ÿèª¿ç¯€é‚è¼¯ï¼šé€£å‹•ä¸Šæ–¹æ‹‰æ¡¿
    function applyMode(mode) {
        const sqz = document.getElementById('i_sqz');
        const poc = document.getElementById('i_poc');
        const drv = document.getElementById('i_drv');
        
        // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„é«˜äº®
        document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active-mode'));

        if(mode === 'ambush') {
            sqz.value = 8; poc.value = 5; drv.value = 40;
            document.getElementById('btn-ambush').classList.add('active-mode');
        } else if(mode === 'hunt') {
            sqz.value = 15; poc.value = 35; drv.value = 110;
            document.getElementById('btn-hunt').classList.add('active-mode');
        } else if(mode === 'vio') {
            sqz.value = 25; poc.value = 15; drv.value = 145;
            document.getElementById('btn-vio').classList.add('active-mode');
        }
    }

    // 90 åˆ†æ—¥èªŒå°é–é‚è¼¯
    function recordHighAsset(asset, price, score) {
        if (score >= 90 && !loggedAssets.has(asset)) {
            const log = document.getElementById('combat-log');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerHTML = `
                <div class="font-black text-white text-sm">${asset.replace('USDT','')} <span class="text-red-500 float-right">SCORE: ${score.toFixed(0)}</span></div>
                <div class="text-[9px] text-zinc-400 mt-1">ç´€éŒ„åƒ¹æ ¼: ${price} | åµæ¸¬æ™‚é–“: ${new Date().toLocaleTimeString()}</div>
            `;
            log.prepend(entry);
            loggedAssets.add(asset);
            document.getElementById('log-count').innerText = loggedAssets.size;
        }
    }

    async function scan() {
        if(!isRunning) return;
        try {
            const bRes = await fetch('https://fapi.binance.com/fapi/v1/ticker/24hr?symbol=BTCUSDT').then(r => r.json());
            const bChg = parseFloat(bRes.priceChangePercent);
            const tRes = await fetch('https://fapi.binance.com/fapi/v1/ticker/24hr').then(r => r.json());
            
            tRes.forEach(t => {
                if (!t.symbol.endsWith('USDT') || CONFIG.EXCLUDE.includes(t.symbol)) return;

                const price = parseFloat(t.lastPrice);
                const altChg = parseFloat(t.priceChangePercent);
                const vol = parseFloat(t.quoteVolume);
                if (vol < 5000000) return;

                const range24h = parseFloat(t.highPrice) - parseFloat(t.lowPrice);
                const sqzVal = (range24h / price) * 100;
                const drvVal = Math.min(150, (Math.abs(altChg) / (vol / 1e8)) * 15);
                
                // R-1 x POC å‹•æ…‹é˜²ç¦¦å…¬å¼
                const pocTighten = Math.max(0.15, 0.6 - (Math.abs(altChg) / 5)); 
                const atrTP = price + (range24h * 1.2); 
                const atrSL = price - (range24h * pocTighten);
                const shieldPos = Math.min(100, Math.max(0, ((price - atrSL) / (atrTP - atrSL)) * 100));

                // æ ¸å¿ƒè¨ˆç®—åˆ†æ•¸
                let score = (sqzVal < 1.1 ? 40 : 10) + (drvVal > 95 ? 35 : 0) + (altChg > bChg + 2.5 ? 25 : 0);

                // æª¢æŸ¥æ˜¯å¦é”æ¨™ä¸¦ç´€éŒ„æ—¥èªŒ
                recordHighAsset(t.symbol, price, score);

                stats[t.symbol] = { s: t.symbol, price, chg: altChg, score, drv: drvVal, atrTP, atrSL, shieldPos, sqz: sqzVal.toFixed(2) };
            });
            render();
        } catch (e) { console.error(e); }
        setTimeout(scan, 2500);
    }

    function render() {
        const dashboard = document.getElementById('dashboard');
        const list = Object.values(stats).sort((a,b) => b.score - a.score).slice(0, 12);

        dashboard.innerHTML = list.map(x => `
            <div class="card p-4 rounded-sm ${x.score >= 90 ? 'high-score' : ''}">
                <div class="flex justify-between items-start mb-3">
                    <h2 class="text-3xl font-black text-white italic tracking-tighter">${x.s.replace('USDT','')}</h2>
                    <div class="text-right">
                        <div class="text-[9px] font-black text-red-500 uppercase">Score</div>
                        <div class="text-3xl font-black text-white leading-none">${x.score.toFixed(0)}</div>
                    </div>
                </div>
                
                <div class="mb-4">
                    <div class="flex justify-between text-[8px] font-black text-zinc-500 mb-1 uppercase">
                        <span>ğŸ›¡ï¸ R-1 SL: ${x.atrSL.toFixed(4)}</span>
                        <span>TP: ${x.atrTP.toFixed(4)}</span>
                    </div>
                    <div class="shield-bg">
                        <div class="shield-fill" style="width: 100%"></div>
                        <div class="shield-pointer" style="left: ${x.shieldPos}%"></div>
                    </div>
                </div>

                <div class="flex justify-between items-end">
                    <div>
                        <div class="text-[9px] font-black text-zinc-500 mb-1 uppercase">Vacuum Drive (DRV)</div>
                        <div class="w-32 h-1.5 bg-zinc-900 rounded-full overflow-hidden">
                            <div class="h-full bg-red-600 shadow-[0_0_10px_red]" style="width: ${(x.drv/150)*100}%"></div>
                        </div>
                    </div>
                    <div class="text-2xl font-black ${x.chg >= 0 ? 'text-green-500' : 'text-red-500'} italic">
                        ${x.chg}%
                    </div>
                </div>
            </div>
        `).join('');
    }

    function toggleSystem() { 
        isRunning = !isRunning; 
        document.getElementById('sysBtn').innerText = isRunning ? "åœæ­¢ç›£æ§" : "å•Ÿå‹•æ ¸å¿ƒæƒæ"; 
        if(isRunning) scan(); 
    }
</script>
</body>
</html>
