<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>âš¡ å°å¹«æ‰‹ X-TREME V14.0 | æˆ°é¬¥æ§åˆ¶å°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;900&family=JetBrains+Mono:wght@400;800&display=swap');
        body { background: #080808; color: #e0e0e0; font-family: 'JetBrains Mono', 'Noto Sans TC', sans-serif; overflow: hidden; }
        .bg-grid { background-image: radial-gradient(#1a1a1a 1px, transparent 1px); background-size: 25px 25px; }

        .card { background: rgba(15, 15, 15, 0.9); border: 1px solid #222; position: relative; }
        .high-score { border: 2px solid #ff0000 !important; box-shadow: 0 0 15px rgba(255,0,0,0.4); }

        .shield-bg { height: 8px; background: #111; border-radius: 4px; position: relative; overflow: hidden; border: 1px solid #333; }
        .shield-fill { height: 100%; background: linear-gradient(90deg, #ff4444, #ffeb3b, #22c55e); opacity: 0.3; }
        .shield-pointer { position: absolute; top: 0; width: 4px; height: 100%; background: #fff; box-shadow: 0 0 8px #fff; transition: 0.3s; }

        #combat-log { font-size: 10px; color: #ffd700; line-height: 1.6; }
        .log-entry { border-left: 2px solid #ffd700; padding: 5px 8px; margin-bottom: 6px; background: rgba(255, 215, 0, 0.05); border-radius: 0 4px 4px 0; }
        
        .mode-btn { transition: 0.2s; border: 1px solid #444; text-transform: uppercase; font-weight: 900; font-style: italic; }
        .mode-btn:hover { transform: translateY(-2px); border-color: #fff; }
        .label-zh { font-size: 11px; font-weight: 900; color: #666; }
    </style>
</head>
<body class="h-screen flex flex-col bg-grid">

    <header class="p-3 border-b-2 border-zinc-800 bg-black flex justify-between items-center">
        <div class="flex items-center gap-6">
            <h1 class="text-3xl font-black text-white italic tracking-tighter uppercase">Helper <span class="text-yellow-500">X-TREME</span></h1>
            <div id="satStatus" class="px-3 py-1 rounded bg-zinc-900 border border-zinc-700 text-[10px] font-bold text-zinc-400">é›·é”å¾…å‘½</div>
        </div>
        <button id="sysBtn" onclick="toggleSystem()" class="bg-yellow-500 text-black px-12 py-2 rounded-sm font-black hover:bg-white transition-all italic uppercase">å•Ÿå‹•æ ¸å¿ƒæƒæ</button>
    </header>

    <nav class="bg-zinc-950 p-4 border-b border-zinc-800 grid grid-cols-12 gap-4 items-center">
        <div class="col-span-4 flex gap-2 border-r border-zinc-800 pr-4">
            <button onclick="setMode('ambush')" class="mode-btn flex-1 bg-green-900/30 text-green-400 py-2 rounded text-[10px]">é€±æœ«åŸ‹ä¼</button>
            <button onclick="setMode('hunt')" class="mode-btn flex-1 bg-red-900/30 text-red-400 py-2 rounded text-[10px]">å¼·å‹¢çµæ®º</button>
            <button onclick="setMode('vio')" class="mode-btn flex-1 bg-purple-900/30 text-purple-400 py-2 rounded text-[10px]">æš´åŠ›ç•°å‹•</button>
        </div>
        
        <div class="col-span-8 grid grid-cols-3 gap-6 px-4">
            <div class="flex flex-col"><span class="label-zh text-zinc-500">è“„å‹¢å¼·åº¦ (SQZ)</span><input type="range" id="i_sqz" min="5" max="50" value="12" class="accent-yellow-500"></div>
            <div class="flex flex-col"><span class="label-zh text-zinc-500">çªç ´è‡¨ç•Œ (POC)</span><input type="range" id="i_poc" min="1" max="100" value="11" class="accent-yellow-500"></div>
            <div class="flex flex-col"><span class="label-zh text-zinc-500">çœŸç©ºé©…å‹• (DRV)</span><input type="range" id="i_drv" min="10" max="150" value="90" class="accent-yellow-500"></div>
        </div>
    </nav>

    <div class="flex flex-1 overflow-hidden">
        <main class="flex-1 p-4 overflow-y-auto">
            <div id="dashboard" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4"></div>
        </main>

        <aside class="w-80 border-l border-zinc-800 bg-black/50 p-4 flex flex-col">
            <div class="label-zh mb-4 border-b border-zinc-800 pb-2 flex justify-between">
                <span class="text-yellow-500 italic">âš”ï¸ 90åˆ†ç´šåˆ¥æˆ°é¬¥ç´€éŒ„</span>
                <span id="log-count" class="text-zinc-600">0</span>
            </div>
            <div id="combat-log" class="flex-1 overflow-y-auto">
                </div>
        </aside>
    </div>

<script>
    const CONFIG = {
        EXCLUDE: ['BTCUSDT','ETHUSDT','SOLUSDT','XRPUSDT','BNBUSDT'],
        SATURDAY_MODE: new Date().getDay() === 6
    };

    let stats = {}, isRunning = false;
    let btcSnapshot = { chg: 0 };
    let loggedAssets = new Set(); 

    // å¿«é€Ÿæ¨¡å¼åƒæ•¸è¨­å®š
    function setMode(type) {
        const sqz = document.getElementById('i_sqz');
        const poc = document.getElementById('i_poc');
        const drv = document.getElementById('i_drv');

        if(type === 'ambush') { sqz.value = 8; poc.value = 5; drv.value = 40; }
        if(type === 'hunt') { sqz.value = 15; poc.value = 25; drv.value = 110; }
        if(type === 'vio') { sqz.value = 20; poc.value = 15; drv.value = 130; }
        
        addLog(`âš¡ æ¨¡å¼åˆ‡æ›ï¼š${type === 'ambush' ? 'é€±æœ«åŸ‹ä¼' : type === 'hunt' ? 'å¼·å‹¢çµæ®º' : 'æš´åŠ›ç•°å‹•'}`, true);
    }

    function addLog(msg, isSystem = false) {
        const log = document.getElementById('combat-log');
        const entry = document.createElement('div');
        entry.className = 'log-entry';
        entry.innerHTML = `<span class="${isSystem ? 'text-zinc-500' : 'text-yellow-500 font-black'}">[${new Date().toLocaleTimeString('zh-TW', {hour12:false})}]</span> ${msg}`;
        log.prepend(entry);
    }

    async function scan() {
        if(!isRunning) return;
        try {
            const bRes = await fetch('https://fapi.binance.com/fapi/v1/ticker/24hr?symbol=BTCUSDT').then(r => r.json());
            btcSnapshot.chg = parseFloat(bRes.priceChangePercent);

            const tRes = await fetch('https://fapi.binance.com/fapi/v1/ticker/24hr').then(r => r.json());
            
            tRes.forEach(t => {
                if (!t.symbol.endsWith('USDT') || CONFIG.EXCLUDE.includes(t.symbol)) return;

                const price = parseFloat(t.lastPrice);
                const altChg = parseFloat(t.priceChangePercent);
                const vol = parseFloat(t.quoteVolume);
                if (vol < 5000000) return;

                const range24h = parseFloat(t.highPrice) - parseFloat(t.lowPrice);
                const pocVal = Math.abs(altChg);
                
                // R-1 è¯å‹• POC
                const pocTighten = Math.max(0.15, 0.6 - (pocVal / 5)); 
                const atrTP = price + (range24h * 1.2); 
                const atrSL = price - (range24h * pocTighten);
                const shieldPos = Math.min(100, Math.max(0, ((price - atrSL) / (atrTP - atrSL)) * 100));

                const drv = Math.min(150, (Math.abs(altChg) / (vol / 1e8)) * 15);
                const lv = Math.min(10, Math.round((drv / 15) + (Math.abs(altChg) / 2)));
                const sqz = (range24h / price) * 100;

                // æ ¸å¿ƒè©•åˆ†
                let score = (sqz < 1.2 ? 40 : 10) + (drv > 90 ? 30 : 0) + (altChg > btcSnapshot.chg + 2 ? 30 : 0);
                if (CONFIG.SATURDAY_MODE && sqz < 0.8) score += 10;

                // 90åˆ†æ—¥èªŒç´€éŒ„é‚è¼¯
                if (score >= 90 && !loggedAssets.has(t.symbol)) {
                    addLog(`ğŸ¯ é”æ¨™ç´€éŒ„: ${t.symbol.replace('USDT','')} | åƒ¹æ ¼: ${price} | åˆ†æ•¸: ${score.toFixed(0)}`);
                    loggedAssets.add(t.symbol);
                }

                stats[t.symbol] = { s: t.symbol, price, chg: altChg, score, lv, drv, atrTP, atrSL, shieldPos, sqz: sqz.toFixed(2) };
            });
            render();
        } catch (e) { console.error(e); }
        setTimeout(scan, 3000);
    }

    function render() {
        const dashboard = document.getElementById('dashboard');
        const list = Object.values(stats).sort((a,b) => b.score - a.score).slice(0, 12);

        dashboard.innerHTML = list.map(x => `
            <div class="card p-4 rounded-sm ${x.score >= 90 ? 'high-score' : ''}">
                <div class="flex justify-between items-start mb-3">
                    <div>
                        <h2 class="text-2xl font-black text-white italic">${x.s.replace('USDT','')}</h2>
                        <div class="label-zh">ç›®å‰åƒ¹æ ¼: ${x.price}</div>
                    </div>
                    <div class="text-right">
                        <div class="label-zh text-yellow-500 italic">æˆ°é¬¥è©•åˆ†</div>
                        <div class="text-3xl font-black text-white leading-none">${x.score.toFixed(0)}</div>
                    </div>
                </div>
                
                <div class="mb-4">
                    <div class="flex justify-between label-zh mb-1">
                        <span>ğŸ›¡ï¸ R-1 æ­¢æé˜²ç·š: ${x.atrSL.toFixed(4)}</span>
                        <span>ç›®æ¨™æ­¢ç›ˆ: ${x.atrTP.toFixed(4)}</span>
                    </div>
                    <div class="shield-bg">
                        <div class="shield-fill" style="width: 100%"></div>
                        <div class="shield-pointer" style="left: ${x.shieldPos}%"></div>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <div class="label-zh mb-1 uppercase">Thrust Level ${x.lv}</div>
                        <div class="h-2 bg-zinc-900 rounded-full overflow-hidden">
                            <div class="h-full bg-yellow-500 shadow-[0_0_10px_#eab308]" style="width: ${x.lv * 10}%"></div>
                        </div>
                    </div>
                    <div class="text-right text-2xl font-black ${x.chg >= 0 ? 'text-green-500' : 'text-red-500'}">
                        ${x.chg}%
                    </div>
                </div>

                <div class="mt-4 pt-2 border-t border-zinc-800 flex justify-between label-zh">
                    <span>è“„å‹¢å£“ç¸®: ${x.sqz}%</span>
                    <span>çœŸç©ºé©…å‹•: ${x.drv.toFixed(0)}</span>
                </div>
            </div>
        `).join('');
    }

    function toggleSystem() { 
        isRunning = !isRunning; 
        document.getElementById('sysBtn').innerText = isRunning ? "åœæ­¢ç³»çµ±" : "å•Ÿå‹•æ ¸å¿ƒæƒæ"; 
        if(isRunning) scan(); 
    }

    document.getElementById('satStatus').innerText = CONFIG.SATURDAY_MODE ? "ğŸ“… é€±å…­æ¨¡å¼å•Ÿå‹•ä¸­" : "âš¡ å¸¸è¦æƒæä¸­";
</script>
</body>
</html>
